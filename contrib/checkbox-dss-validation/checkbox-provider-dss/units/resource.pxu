id: host_has_intel_gpus
category_id: dss-regress
plugin: resource
imports: from com.canonical.certification import executable
requires: executable.name == 'intel_gpu_top'
_summary: Verify that an Intel GPU is available on the host
estimated_duration: 5s
command:
  result=$(intel_gpu_top -L)
  if [[ ${result} == *"pci:vendor=8086"* ]]; then
      echo "available: true"
  else
      echo "available: false"
  fi

id: host_has_nvidia_gpus
category_id: dss-regress
plugin: resource
imports: from com.canonical.certification import executable
requires: executable.name == 'lspci'
_summary: Verify that an NVIDIA GPU is available on the host
estimated_duration: 5s
command:
  result="$(lspci | grep -ci 'nvidia')"
  if [[ "$result" -ge 1 ]]; then
      echo "available: true"
  else
      echo "available: false"
  fi
